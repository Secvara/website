{{ define "main" }}
{{/*  hero  */}}
{{ with .Params.hero_section }}
<div class="bg-background flex relative z-20 items-center overflow-hidden">
    <div id="animation-container" class="absolute inset-0 size-full z-20">
        <div class="circle size-50 rounded-full bg-red-700/30 absolute"></div>
        <div class="circle size-50 rounded-full bg-green-700/50 absolute"></div>
        <div class="circle size-50 rounded-full bg-blue-700/30 absolute"></div>
    </div>
    {{/*  <div class="absolute size-150 rounded-tl-full bg-gradient-to-br from-transparent to-primary right-0 bottom-0 z-10"></div>  */}}
    <div class="size-full pt-34 lg:pt-20 min-h-screen flex justify-center items-center backdrop-blur-2xl backdrop-saturate-250 bg-black/20 relative z-30">
        <div class="container mx-auto px-6 grid grid-cols-1 lg:grid-cols-2 items-center gap-20 pb-10 lg:pb-0">
            <div class="flex flex-col gap-7">
                <span class="w-20 h-2 bg-white"></span>
                <h1 class="font-primary uppercase text-2xl font-black flex flex-col leading-10 tracking-wider text-white main-heading">
                    {{ .title | safeHTML }}
                </h1>
                <p class="text-sm sm:text-base text-white font-primary tracking-wide">
                    {{ .details | safeHTML }}
                </p>
                <div class="flex">
                    <a href="{{ .btn }}" {{ if .outbound }}target="_blank"{{ end }} class="uppercase font-primary py-2 px-4 rounded-lg bg-primary border-2 border-transparent text-white text-md mr-4 hover:bg-primary/80 transition-colors">
                        Become Secvara SECURE
                    </a>
                </div>
            </div>
            <div>
                <img src='{{ "images/undraw_security.svg" | relURL }}' class="size-full mx-auto lg:mx-0 lg:ml-auto object-right"/>
            </div>
        </div>
    </div>
</div>
{{ end }}
{{/*  end hero  */}}

{{/*  fit section (moved above about) */}}
{{ with .Params.fit_section }}
<section id="fit" class="py-20 bg-white scroll-mt-20">
    <div class="max-w-lg mx-auto flex flex-col items-center px-6 space-y-20">
        <h3 class="font-primary uppercase text-3xl font-extrabold leading-10 tracking-wider text-black main-heading">
            {{ .title | safeHTML }}
        </h3>
        <div>
            {{ $len := len .boxes }}
            {{ range $i, $p := .boxes }}
            <div>
                <div class="grid grid-cols-12 rounded-lg bg-white shadow-xl border border-black/10">
                    <div class="rounded-r-full rounded-l-lg col-span-1 bg-primary text-white flex justify-center items-center">
                        <svg class="size-7 text-inherit" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path class="fill-current" d="M19.2803 6.76264C19.5732 7.05553 19.5732 7.53041 19.2803 7.8233L9.86348 17.2402C9.57058 17.533 9.09571 17.533 8.80282 17.2402L4.71967 13.157C4.42678 12.8641 4.42678 12.3892 4.71967 12.0963C5.01256 11.8035 5.48744 11.8035 5.78033 12.0963L9.33315 15.6492L18.2197 6.76264C18.5126 6.46975 18.9874 6.46975 19.2803 6.76264Z" fill="#323544"/>
                        </svg>
                    </div>
                    <span class="p-3 text-lg font-primary text-black col-span-11">
                        {{ $p | safeHTML }}
                    </span>
                </div>
                {{ if ne (add $i 1) $len }}
                <div class="h-14 w-1 bg-primary"></div>
                {{ end }}
            </div>
            {{ end }}
        </div>

        {{/* Removed SECURE Path + How We Work preview from Fit; rendered below */}}

    </div>
</section>
{{ end }}
{{/*  end fit  */}}

{{/*  about section  */}}
{{ with .Params.about_section }}
<section id="about" class="py-20 bg-light-alt scroll-mt-20">
    <div class="container mx-auto px-6 grid grid-cols-1 lg:grid-cols-2 gap-20">
        <div class="space-y-7">
            <span class="w-20 h-2 bg-black inline-block"></span>
            <h3 class="font-primary uppercase text-3xl font-extrabold flex flex-col leading-10 tracking-wider text-black main-heading">
                {{ .title | safeHTML }}
            </h3>
        </div>
        <div class="font-primary text-xl leading-7 tracking-wide">
            <p>{{ .details | safeHTML }}</p>
            {{ $btn := (.btn | default "https://cal.com/secvara/pre-sra") }}
            <div class="mt-6 flex items-center gap-4 flex-wrap">
                <a href="{{ $btn }}" {{ if .outbound }}target="_blank"{{ end }} class="uppercase font-primary py-2 px-4 rounded-lg bg-primary border-2 border-transparent text-white text-md hover:bg-primary/80 transition-colors">Become Secvara SECURE</a>
            </div>
        </div>
    </div>
</section>
{{ end }}
{{/*  end about */}}

{{/*  fit section removed (now rendered above) */}}

{{/*  flow chart section (moved above services) */}}
{{ with .Params.flow_chart_section }}
<section id="chart" class="py-20 bg-white">
    <div class="container mx-auto px-6 space-y-20">
        <div class="text-center">
            <h3 class="font-primary uppercase text-3xl font-extrabold leading-10 tracking-wider text-black main-heading">
                {{ .title | safeHTML }}
            </h3>
        </div>
        <div class="space-y-30">
          {{ with .secure_path }}
            {{ $steps := .steps }}
            {{ $last := sub (len $steps) 1 }}
            {{ range $i, $s := $steps }}
              {{ $type := printf "%T" $s }}
              {{ $pos := "" }}
              {{ if eq $i 0 }}{{ $pos = " lg:mx-0" }}{{ end }}
              {{ if eq $i $last }}{{ $pos = " lg:mr-0 lg:ml-auto" }}{{ end }}
              {{ if eq $type "string" }}
                {{ $parts := split $s ":" }}
                {{ $t := (index $parts 0 | trim) }}
                {{ $d := (delimit (after 1 $parts) ":" | trim) }}
                <div class="bg-white rounded-lg text-lg font-primary max-w-md sm:max-w-lg mx-auto flex flex-col sm:flex-row border-3 border-dashed border-primary relative{{ $pos }}">
                  <div class="bg-primary/40 sm:rounded-l-lg sm:w-2/6 min-h-10 font-primary text-2xl text-black font-bold justify-center items-center flex">Step {{ add $i 1 }}</div>
                  <div class="py-2 px-5 font-primary text-black shadow-inner space-y-2 relative z-20 bg-white">
                    <strong class="text-lg font-bold">{{ $t }}</strong>
                    {{ if $d }}<p class="text-sm">{{ $d }}</p>{{ end }}
                  </div>
                  {{ if lt $i $last }}
                    {{ partial "svg/curved-arrow.html" (dict "class" "w-60 absolute z-10 top-10 left-1/2 -translate-x-1/2 sm:left-auto sm:translate-x-0 sm:top-0 sm:right-0 lg:top-auto lg:-right-44") }}
                  {{ end }}
                </div>
              {{ else }}
                {{ range $k, $v := $s }}
                  <div class="bg-white rounded-lg text-lg font-primary max-w-md sm:max-w-lg mx-auto flex flex-col sm:flex-row border-3 border-dashed border-primary relative{{ $pos }}">
                    <div class="bg-primary/40 sm:rounded-l-lg sm:w-2/6 min-h-10 font-primary text-2xl text-black font-bold justify-center items-center flex">Step {{ add $i 1 }}</div>
                    <div class="py-2 px-5 font-primary text-black shadow-inner space-y-2 relative z-20 bg-white">
                      <strong class="text-lg font-bold">{{ $k }}</strong>
                      {{ if $v }}<p class="text-sm">{{ $v }}</p>{{ end }}
                    </div>
                    {{ if lt $i $last }}
                      {{ partial "svg/curved-arrow.html" (dict "class" "w-60 absolute z-10 top-10 left-1/2 -translate-x-1/2 sm:left-auto sm:translate-x-0 sm:top-0 sm:right-0 lg:top-auto lg:-right-44") }}
                    {{ end }}
                  </div>
                {{ end }}
              {{ end }}
            {{ end }}
          {{ end }}

          {{/* How We Work dynamic grid */}}
          {{ with .how_we_work }}
            <div class="space-y-8 mt-16">
              <div class="text-center">
                <h4 class="font-primary uppercase text-2xl font-extrabold leading-10 tracking-wider text-black">{{ .title | safeHTML }}</h4>
              </div>
              {{ with .steps }}
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                {{ range . }}
                  {{ $type := printf "%T" . }}
                  {{ if eq $type "string" }}
                    {{ $parts := split . ":" }}
                    {{ $t := (index $parts 0 | trim) }}
                    {{ $d := (delimit (after 1 $parts) ":" | trim) }}
                    <div class="bg-white border border-black/10 p-6 rounded-lg shadow">
                      <div class="font-primary font-bold text-lg mb-2">{{ $t }}</div>
                      {{ if $d }}<p class="font-primary text-black/80">{{ $d }}</p>{{ end }}
                    </div>
                  {{ else }}
                    {{ range $k, $v := . }}
                      <div class="bg-white border border-black/10 p-6 rounded-lg shadow">
                        <div class="font-primary font-bold text-lg mb-2">{{ $k }}</div>
                        {{ if $v }}<p class="font-primary text-black/80">{{ $v }}</p>{{ end }}
                      </div>
                    {{ end }}
                  {{ end }}
                {{ end }}
              </div>
              {{ end }}
              {{ with .links }}
              <div class="text-center">
                {{ range . }}
                  <a href="{{ .href | relURL }}" class="uppercase font-primary py-2 px-4 rounded-lg bg-primary border-2 border-transparent text-white text-md mr-3 hover:bg-primary/80">{{ .label }}</a>
                {{ end }}
              </div>
              {{ end }}
            </div>
          {{ end }}
        </div>
    </div>
</section>
{{ end }}
{{/*  end flow chart  */}}

{{/*  services section  */}}
{{ with .Params.services_section }}
<section id="services" class="py-20 bg-white scroll-mt-20">
    <div class="container mx-auto px-6 space-y-24">
        </div>

        {{/* Deliverables cards (band styled like FIT) */}}
        {{ with .deliverables }}
        <div class="py-20 bg-light-alt">
          <div class="container mx-auto px-6 space-y-8">
            <h3 class="font-primary uppercase text-3xl font-extrabold leading-10 tracking-wider text-black main-heading text-center">{{ $.Params.services_section.title | safeHTML }}</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {{ range .cards }}
              {{ if or .name .blurb }}
              <a class="block p-6 rounded-lg border border-black/10 shadow hover:shadow-lg transition bg-white" href="{{ with .link }}{{ . | relURL }}{{ end }}">
                <h5 class="font-primary text-lg font-bold mb-2">{{ .name }}</h5>
                <p class="font-primary text-black/80">{{ .blurb }}</p>
                {{ with .tiers }}
                <div class="mt-3 flex flex-wrap gap-2">
                  {{ range . }}
                  <span class="inline-block text-xs font-medium bg-primary/10 text-black px-2 py-1 rounded">{{ . }}</span>
                  {{ end }}
                </div>
                {{ end }}
              </a>
              {{ end }}
              {{ end }}
            </div>
          </div>
        </div>
        {{ end }}

        {{/* Tiers (moved below deliverables) */}}
        {{ with .tiers }}
        <div class="container mx-auto px-6 space-y-8 mt-10">
          <h4 class="font-primary text-2xl font-extrabold text-center">Tiers</h4>
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            {{ range . }}
            <div class="bg-white border border-black/10 p-6 rounded-lg shadow h-full flex flex-col">
              <h5 class="font-primary text-xl font-bold mb-2">{{ .name }}</h5>
              <p class="font-primary text-black/80 mb-4">{{ .blurb }}</p>
              {{ with .bullets }}
              <ul class="list-disc pl-5 font-primary text-black/80 mb-4">
                {{ range . }}<li>{{ . }}</li>{{ end }}
              </ul>
              {{ end }}
              <div class="mt-auto pt-2 flex items-center gap-3">
                <a class="uppercase font-primary py-2 px-4 rounded-lg bg-primary text-white hover:bg-primary/80" href="https://cal.com/secvara/pre-sra" target="_blank">Book a Call</a>
                {{ if .link }}
                  <a class="font-primary text-sm text-black/70 hover:text-black underline" href="{{ .link | relURL }}">Learn more</a>
                {{ end }}
              </div>
            </div>
            {{ end }}
          </div>
        </div>
        {{ end }}

        {{/* Pricing snippet removed; pricing shown per tier */}}

    </div>
</section>
{{ end }}
{{/*  end services  */}}

{{/*  flow chart section removed from here; moved above services */}}

{{/*  faq section  */}}
{{ with .Params.faqs_section }}
<section id="faqs" class="py-20 bg-light-alt space-y-20 scroll-mt-20">
    <div class="max-w-lg mx-auto text-center">
        <h3 class="font-primary uppercase text-3xl font-extrabold leading-10 tracking-wider text-black main-heading">
            {{ .title | safeHTML }}
        </h3>
    </div>
    <div class="mx-auto px-6 max-w-xl divide-y divide-black/10">
        {{ range .faq }}
        <div class="py-5">
            <details class="group">
                <summary class="flex cursor-pointer list-none items-center justify-between font-medium font-primary">
                    <span class="text-xl">{{ .question | safeHTML }}</span>
                    <span class="transition group-open:rotate-180">
                            <svg fill="none" height="24" shape-rendering="geometricPrecision"
                                stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                stroke-width="1.5" viewBox="0 0 24 24" width="24">
                                <path d="M6 9l6 6 6-6"></path>
                            </svg>
                        </span>
                </summary>
                <p class="group-open:animate-fadeIn mt-3 text-black/80 font-primary">
                    {{ .answer | safeHTML }}
                </p>
            </details>
        </div>
        {{ end }}
    </div>
</section>
{{ end }}
{{/*  end faq  */}}

{{/*  cta section  */}}
{{ with .Params.cta_section }}
<section id="cta" class="py-20 bg-background">
    <div class="container mx-auto px-6 grid grid-cols-1 md:grid-cols-2 gap-20 items-center">
        <h3 class="font-primary uppercase text-3xl font-extrabold leading-10 tracking-wider text-white main-heading">
            {{ .title | safeHTML }}
        </h3>
        <div class="space-y-20 md:space-y-7">
            <p class="font-primary text-xl leading-7 tracking-wide text-white">
                {{ .details | safeHTML }}
            </p>
            <div class="flex">
                <a href="{{ .btn }}" {{ if .outbound }}target="_blank"{{ end }} class="uppercase font-primary py-2 px-4 rounded-lg bg-primary border-2 border-transparent text-white text-md mr-4 hover:bg-primary/80 transition-colors">
                    Become Secvara SECURE
                </a>
            </div>
        </div>
    </div>
</section>
{{ end }}
{{/*  end cta  */}}
{{ end }}
